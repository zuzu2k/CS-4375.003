library(pvclust)
install.packages("pvclust")
# Replacing column names for rbind
colnames(win_stats_df) <- c('kill1', 'kill2', 'kill3', 'kill4', 'kill5', 'death1', 'death2', 'death3', 'death4', 'death5', 'totalDamageDealtToChampions1', 'totalDamageDealtToChampions2', 'totalDamageDealtToChampions3', 'totalDamageDealtToChampions4', 'totalDamageDealtToChampions5', 'goldEarned1', 'goldEarned2', 'goldEarned3', 'goldEarned4', 'goldEarned5', 'visionScore1', 'visionScore2', 'visionScore3', 'visionScore4', 'visionScore5', 'totalTimeCrowdControlDealt1', 'totalTimeCrowdControlDealt2', 'totalTimeCrowdControlDealt3', 'totalTimeCrowdControlDealt4', 'totalTimeCrowdControlDealt5', 'gameId')
library(pvclust)
library(flexclust)
win_stats_df <- read.csv((unz("League_Data/league_korea_high_elo_team_stats.zip", "win_team_stats.csv")))
lose_stats_df <- read.csv((unz("League_Data/league_korea_high_elo_team_stats.zip", "lose_team_stats.csv")))
str(win_stats_df)
str(lose_stats_df)
# Replacing column names for rbind
colnames(win_stats_df) <- c('kill1', 'kill2', 'kill3', 'kill4', 'kill5', 'death1', 'death2', 'death3', 'death4', 'death5', 'totalDamageDealtToChampions1', 'totalDamageDealtToChampions2', 'totalDamageDealtToChampions3', 'totalDamageDealtToChampions4', 'totalDamageDealtToChampions5', 'goldEarned1', 'goldEarned2', 'goldEarned3', 'goldEarned4', 'goldEarned5', 'visionScore1', 'visionScore2', 'visionScore3', 'visionScore4', 'visionScore5', 'totalTimeCrowdControlDealt1', 'totalTimeCrowdControlDealt2', 'totalTimeCrowdControlDealt3', 'totalTimeCrowdControlDealt4', 'totalTimeCrowdControlDealt5', 'gameId')
colnames(lose_stats_df) <- c('kill1', 'kill2', 'kill3', 'kill4', 'kill5', 'death1', 'death2', 'death3', 'death4', 'death5', 'totalDamageDealtToChampions1', 'totalDamageDealtToChampions2', 'totalDamageDealtToChampions3', 'totalDamageDealtToChampions4', 'totalDamageDealtToChampions5', 'goldEarned1', 'goldEarned2', 'goldEarned3', 'goldEarned4', 'goldEarned5', 'visionScore1', 'visionScore2', 'visionScore3', 'visionScore4', 'visionScore5', 'totalTimeCrowdControlDealt1', 'totalTimeCrowdControlDealt2', 'totalTimeCrowdControlDealt3', 'totalTimeCrowdControlDealt4', 'totalTimeCrowdControlDealt5', 'gameId')
# Adding column based on dataset it is in
library(dplyr)
win_stats_df <- win_stats_df %>%
mutate(won=1)
lose_stats_df <- lose_stats_df %>%
mutate(won =0)
#full_stats_df <- merge(win_stats_df, lose_stats_df, by = "gameId")
full_stats_df <- rbind(win_stats_df, lose_stats_df)
drop <- c("gameId")
full_stats_df <- full_stats_df[,!(names(full_stats_df) %in% drop)]
str(full_stats_df)
set.seed(1234)
lolCluster <- kmeans( full_stats_df, 5)
lolCluster
table(lolCluster$cluster, full_stats_df$won)
plot(full_stats_df$kill5, full_stats_df$totalDamageDealtToChampions5, pch=21, bg=c("red", "orange", "yellow" , "green", "blue" )[unclass(lolCluster$cluster)], main="League of Legends Dataset")
set.seed(1010)
i <- sample(1:nrow(full_stats_df), .75*nrow(full_stats_df), replace=FALSE)
full_stats_smol <- full_stats_df[-i,]
full.scaled <- scale(full_stats_smol)
d <- dist(full.scaled)
fit.average <- hclust(d, method="average")
plot(fit.average, hang=-1, cex=.8, main="Hierarchical Clustering")
plot(full_stats_df$kill5, full_stats_df$totalDamageDealtToChampions5, pch=21, bg=c("red", "orange", "yellow" , "green", "blue" )[unclass(lolCluster$cluster)], main="League of Legends Dataset")
plot(full_stats_df$kill1+full_stats_df$kill2+full_stats_df$kill3+full_stats_df$kill4+full_stats_df$kill5, full_stats_df$totalDamageDealtToChampions1+full_stats_df$totalDamageDealtToChampions2+full_stats_df$totalDamageDealtToChampions3+full_stats_df$totalDamageDealtToChampions4+full_stats_df$totalDamageDealtToChampions5, pch=21, bg=c("red", "orange", "yellow" , "green", "blue" )[unclass(lolCluster$cluster)], main="League of Legends Dataset")
plot(full_stats_df$kill5, full_stats_df$totalDamageDealtToChampions5, pch=21, bg=c("red", "orange", "yellow" , "green", "blue" )[unclass(lolCluster$cluster)], main="League of Legends Dataset")
plot(full_stats_df$kill1+full_stats_df$kill2+full_stats_df$kill3+full_stats_df$kill4+full_stats_df$kill5, full_stats_df$totalDamageDealtToChampions1+full_stats_df$totalDamageDealtToChampions2+full_stats_df$totalDamageDealtToChampions3+full_stats_df$totalDamageDealtToChampions4+full_stats_df$totalDamageDealtToChampions5, pch=21, bg=c("red", "orange", "yellow" , "green", "blue" )[unclass(lolCluster$cluster)], main="League of Legends Dataset")
plot(full_stats_df$kill1+full_stats_df$kill2+full_stats_df$kill3+full_stats_df$kill4+full_stats_df$kill5,full_stats_df$won, pch=21, bg=c("red", "orange", "yellow" , "green", "blue" )[unclass(lolCluster$cluster)], main="League of Legends Dataset")
plot(full_stats_df$kill5, full_stats_df$totalDamageDealtToChampions5, pch=21, bg=c("red", "orange", "yellow" , "green", "blue" )[unclass(lolCluster$cluster)], main="League of Legends Dataset")
plot(full_stats_df$kill1+full_stats_df$kill2+full_stats_df$kill3+full_stats_df$kill4+full_stats_df$kill5, full_stats_df$totalDamageDealtToChampions1+full_stats_df$totalDamageDealtToChampions2+full_stats_df$totalDamageDealtToChampions3+full_stats_df$totalDamageDealtToChampions4+full_stats_df$totalDamageDealtToChampions5, pch=21, bg=c("red", "orange", "yellow" , "green", "blue" )[unclass(lolCluster$cluster)], main="League of Legends Dataset")
plot(full_stats_df$totalTimeCrowdControlDealt1+full_stats_df$totalTimeCrowdControlDealt2+full_stats_df$totalTimeCrowdControlDealt3+full_stats_df$totalTimeCrowdControlDealt4+full_stats_df$totalTimeCrowdControlDealt5, full_stats_df$totalDamageDealtToChampions1+full_stats_df$totalDamageDealtToChampions2+full_stats_df$totalDamageDealtToChampions3+full_stats_df$totalDamageDealtToChampions4+full_stats_df$totalDamageDealtToChampions5, pch=21, bg=c("red", "orange", "yellow" , "green", "blue" )[unclass(lolCluster$cluster)], main="League of Legends Dataset")
plot(full_stats_df$goldEarned1+full_stats_df$goldEarned2+full_stats_df$goldEarned3+full_stats_df$goldEarned4+full_stats_df$goldEarned5, full_stats_df$visionScore1+full_stats_df$visionScore2+full_stats_df$visionScore3+full_stats_df$visionScore4+full_stats_df$visionScore5, pch=21, bg=c("red", "orange", "yellow" , "green", "blue" )[unclass(lolCluster$cluster)], main="League of Legends Dataset")
plot(full_stats_df$kill5, full_stats_df$totalDamageDealtToChampions5, pch=21, bg=c("red", "orange", "yellow" , "green", "blue" )[unclass(lolCluster$cluster)], main="League of Legends Dataset")
plot(full_stats_df$totalDamageDealtToChampions1+full_stats_df$totalDamageDealtToChampions2+full_stats_df$totalDamageDealtToChampions3+full_stats_df$totalDamageDealtToChampions4+full_stats_df$totalDamageDealtToChampions5, full_stats_df$kill1+full_stats_df$kill2+full_stats_df$kill3+full_stats_df$kill4+full_stats_df$kill5, pch=21, bg=c("red", "orange", "yellow" , "green", "blue" )[unclass(lolCluster$cluster)], main="League of Legends Dataset")
plot(full_stats_df$totalDamageDealtToChampions1+full_stats_df$totalDamageDealtToChampions2+full_stats_df$totalDamageDealtToChampions3+full_stats_df$totalDamageDealtToChampions4+full_stats_df$totalDamageDealtToChampions5, full_stats_df$totalTimeCrowdControlDealt1+full_stats_df$totalTimeCrowdControlDealt2+full_stats_df$totalTimeCrowdControlDealt3+full_stats_df$totalTimeCrowdControlDealt4+full_stats_df$totalTimeCrowdControlDealt5, pch=21, bg=c("red", "orange", "yellow" , "green", "blue" )[unclass(lolCluster$cluster)], main="League of Legends Dataset")
plot(full_stats_df$goldEarned1+full_stats_df$goldEarned2+full_stats_df$goldEarned3+full_stats_df$goldEarned4+full_stats_df$goldEarned5, full_stats_df$visionScore1+full_stats_df$visionScore2+full_stats_df$visionScore3+full_stats_df$visionScore4+full_stats_df$visionScore5, pch=21, bg=c("red", "orange", "yellow" , "green", "blue" )[unclass(lolCluster$cluster)], main="League of Legends Dataset")
